@require(page, text, data_nodes, labels, shapes, groups, interactions, color_definitions, graphrefs, graphids)
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.0//EN'
          'http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd'>

<svg xmlns:xlink="http://www.w3.org/1999/xlink" style="fill-opacity:1; color-rendering:auto; color-interpolation:auto; stroke:black; text-rendering:auto; stroke-linecap:square; stroke-miterlimit:10; stroke-opacity:1; shape-rendering:auto; fill:black; stroke-dasharray:none; font-weight:normal; stroke-width:1; font-family:&apos;Dialog&apos;; font-style:normal; stroke-linejoin:miter; font-size:12; stroke-dashoffset:0; image-rendering:auto;" width="@page['boardwidth']!s" height="@page['boardheight']!s" xmlns="http://www.w3.org/2000/svg"
><!--Generated by MetaPath-->

<style><![CDATA[

.group {
    fill: rgb(180,180,100);
    fill-opacity: 0.098;
    stroke-width:1;
    stroke-dasharray:4,2;
    stroke-miterlimit:1;
    stroke:gray;
}

.complex {
    stroke-dasharray:1;
}

.label {
    stroke:none;
    text-anchor:middle;
    dominant-baseline: central;
    font-weight:bold;
    font-size:14px;
}

.datanode {
    fill:white;
}

.shape {
    fill:white;
}



.line {
    fill: none;
    stroke-width:1; 
}

.datanode text {
    stroke:none;
    text-anchor:middle;
    dominant-baseline: central;
    font-size:10px;
    }

.metabolite path { stroke: blue; }
.metabolite text { fill: blue; }

.geneproduct path { stroke: black; }
.geneproduct text { fill: black;  }

.pathway path { stroke: rgb(20,150,30); }
.pathway text { fill: rgb(20,150,30); font-weight: bold; font-size:12px;
 }

]]></style>

    <defs>

        <!-- Need to generate a set of line ending markers for each color we want to use -->
        @for c in color_definitions:
            <marker id='sArrow_@c!s' orient='auto' markerWidth='12' markerHeight='10' refX='0' refY='5' markerUnits="strokeWidth">
                <path d='M12,0 V10 L0,5 Z' style="stroke:none; fill:#@c;"/>
            </marker>

            <marker id='eArrow_@c!s' orient='auto' markerWidth='12' markerHeight='10' refX='12' refY='5' markerUnits="strokeWidth">
                <path d='M0,0 V10 L12,5 Z' style="stroke:none; fill:#@c;"/>
            </marker>

            <marker id='smim-stimulation_@c!s' orient='auto' markerWidth='12' markerHeight='10' refX='0' refY='5' markerUnits="strokeWidth">
                <path d='M12,0 V10 L0,5 Z' style="stroke:#@c; fill:white;"/>
            </marker>

            <marker id='emim-stimulation_@c!s' orient='auto' markerWidth='12' markerHeight='10' refX='12' refY='5' markerUnits="strokeWidth">
                <path d='M0,0 V10 L12,5 Z' style="stroke:#@c; fill:white;"/>
            </marker>

            <marker id='smim-catalysis_@c!s' orient='auto' markerWidth='12' markerHeight='12' refX='-12' refY='6' markerUnits="strokeWidth">
                <circle cx='6' cy='6' r='5' style="fill:white; stroke:#@c;"/>
            </marker>

            <marker id='emim-catalysis_@c!s' orient='auto' markerWidth='12' markerHeight='12' refX='12' refY='6' markerUnits="strokeWidth">
                <circle cx='6' cy='6' r='5' style="fill:white; stroke:#@c;"/>
            </marker>
        @endfor

    </defs>
  
    <g class="text">
        @for k,t in text.items():
            <text x="10" y="@t[1]!s" style="fill:black; stroke:none;"><tspan style="font-weight:bold;@">@k:</tspan> @t[0]</text>
        @endfor
    </g>
  
    <g class="shape" >
        @for o in shapes:
            @if o['shape_type'] == 'RoundedRectangle':   
                <rect x="@o['xo']!s" y="@o['yo']!s" rx="@o['rx']!s" ry="@o['ry']!s" width="@o['width']!s" height="@o['height']!s" style="
            @for s in o['styles']:
                @s!s                
            @endfor
            "/>
            @else:
                <rect x="@o['xo']!s" y="@o['yo']!s" width="@o['width']!s" height="@o['height']!s" style="
            @for s in o['styles']:
                @s!s                
            @endfor
            "/>
            @endif 
        @endfor
    </g>

    <g class="label">
        @for o in labels:
                <a xlink:href="metapath://">
                    <text x="@o['xc']!s" y="@o['yc']!s" style="
                    @for s in o['styles']:
                        @s!s                
                    @endfor
                    ">
                    @if len(o['text']) == 1:
                            @o['text'][0]
                    @else:
                        <tspan x="@o['xc']!s" dy="-0.2em">@o['text'][0]</tspan>
                        @for t in o['text'][1:]:
                            <tspan x="@o['xc']!s" dy="1.2em">@t</tspan>
                        @endfor
                    @endif
                    </text>    
                </a>
        @endfor
    </g>

    <g class="line">
    @for o in interactions:
        <polyline points="
            @for p in o['path']:
                @p[0]!s,@p[1]!s
            @endfor
            " style="
            @for s in o['styles']:
                @s!s                
            @endfor
            " marker-start="url(#@o['marker_start']_@o['color']!s)" marker-end="url(#@o['marker_end']_@o['color']!s)"/>
    @endfor
    </g>    

    <g class="group">
        @for o in groups:
            @if o['gstyle'] == 'complex':
                <path d="M@o['x1']!s @o['y1']!s L@o['x2']!s @o['y2']!s L@o['x3']!s @o['y3']!s L@o['x4']!s @o['y4']!s L@o['x5']!s @o['y5']!s L@o['x6']!s @o['y6']!s L@o['x7']!s @o['y7']!s L@o['x8']!s @o['y8']!s Z" class="@o['gstyle']"/> 
            @else:
                <rect x="@o['xo']!s" y="@o['yo']!s" width="@o['width']!s" height="@o['height']!s" class="@o['gstyle']"/>
            @endif
        @endfor
    </g>
 
    <g class="datanode">
        @for o in data_nodes:
            <g class="@o['type']">
                <path d="M@o['xo']!s @o['yo']!s L@o['xt']!s @o['yo']!s L@o['xt']!s @o['yt']!s L@o['xo']!s @o['yt']!s L@o['xo']!s @o['yo']!s Z" style="
                @for s in o['node_styles']:
                    @s!s                
                @endfor
                " />
                <a xlink:href="@o['url']!s">
                    <text x="@o['xc']!s" y="@o['yc']!s" style="
                    @for s in o['text_styles']:
                        @s!s                
                    @endfor
                    ">
                    @if len(o['text']) == 1:
                            @o['text'][0]
                    @else:
                        <tspan x="@o['xc']!s" dy="-0.2em">@o['text'][0]</tspan>
                        @for t in o['text'][1:]:
                            <tspan x="@o['xc']!s" dy="1.2em">@t</tspan>
                        @endfor
                    @endif
                    </text>    
                </a>
            </g>
    @endfor
    </g>


</svg>